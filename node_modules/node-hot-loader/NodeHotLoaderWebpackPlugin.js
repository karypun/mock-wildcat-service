"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;

var _HmrServer = _interopRequireDefault(require("./HmrServer"));

var _loader = require("./loader");

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }

class NodeHotLoaderWebpackPlugin {
  /**
   * @param {{
   *  force?: boolean;
   *  fork?: boolean | string[];
   *  args?: string[];
   *  autoRestart?: boolean;
   *  inMemory?: boolean;
   *  logLevel?: string;
   * }} options
   */
  constructor(options = {}) {
    _defineProperty(this, "options", void 0);

    this.options = options;
  }
  /**
   * @param {import('webpack').Compiler} compiler
   */


  apply(compiler) {
    if (!this.options.force && !compiler.options.watch) return;
    (0, _loader.tweakWebpackConfig)(compiler.options);
    const hmrServer = new _HmrServer.default({
      compiler,
      ...this.options
    });
    hmrServer.run(false);
  }

}

exports.default = NodeHotLoaderWebpackPlugin;